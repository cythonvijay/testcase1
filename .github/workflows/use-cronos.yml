name: CRONOS Analysis

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  cronos:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 2  # Get current + previous commit for diff
      
      - name: Run CRONOS Analysis
        uses: cythonvijay/cronos-action@v1
        with:
          api_url: ${{ secrets.CRONOS_API_URL }}
          mode: STRICT  # Options: STRICT, BOUNDARY, CONTRACT
      
      - name: Upload Analysis Reports
        uses: actions/upload-artifact@v4
        if: always()  # Upload even if analysis fails
        with:
          name: cronos-reports
          path: cronos-reports/
          retention-days: 30
